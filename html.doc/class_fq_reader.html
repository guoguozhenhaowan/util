<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UTIL: FqReader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UTIL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="class_fq_reader-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FqReader Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class to hold a fastq reader.  
 <a href="class_fq_reader.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="fqreader_8h_source.html">fqreader.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaa7e02f18816df90b46c039cf59b48c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#aaa7e02f18816df90b46c039cf59b48c1">FqReader</a> (const std::string &amp;filename, const bool &amp;hasQuality=true, const bool &amp;phread64=false)</td></tr>
<tr class="memdesc:aaa7e02f18816df90b46c039cf59b48c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a <a class="el" href="class_fq_reader.html" title="Class to hold a fastq reader.">FqReader</a> with filename and hasQuality, phread64.  <a href="#aaa7e02f18816df90b46c039cf59b48c1">More...</a><br /></td></tr>
<tr class="separator:aaa7e02f18816df90b46c039cf59b48c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0df86a5b513143ed4073a9de1e88b375"><td class="memItemLeft" align="right" valign="top"><a id="a0df86a5b513143ed4073a9de1e88b375"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#a0df86a5b513143ed4073a9de1e88b375">~FqReader</a> ()</td></tr>
<tr class="memdesc:a0df86a5b513143ed4073a9de1e88b375"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_fq_reader.html" title="Class to hold a fastq reader.">FqReader</a> Destructor. <br /></td></tr>
<tr class="separator:a0df86a5b513143ed4073a9de1e88b375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0722aec7836a4c9b9eb6ff80263b246"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#ae0722aec7836a4c9b9eb6ff80263b246">eof</a> ()</td></tr>
<tr class="memdesc:ae0722aec7836a4c9b9eb6ff80263b246"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tell whether the <a class="el" href="class_fq_reader.html" title="Class to hold a fastq reader.">FqReader</a> has reach the endof file.  <a href="#ae0722aec7836a4c9b9eb6ff80263b246">More...</a><br /></td></tr>
<tr class="separator:ae0722aec7836a4c9b9eb6ff80263b246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade5fd276d5eb3eaafcddeadaa4ec40d4"><td class="memItemLeft" align="right" valign="top"><a id="ade5fd276d5eb3eaafcddeadaa4ec40d4"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#ade5fd276d5eb3eaafcddeadaa4ec40d4">getBytes</a> (size_t &amp;bytesRead, size_t &amp;bytesTotal)</td></tr>
<tr class="memdesc:ade5fd276d5eb3eaafcddeadaa4ec40d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of Bytes read from(write to) the fastq file in the meantime, store it in bytesRead Get the total number of Bytes in the fastq file, store it in bytesTotal. <br /></td></tr>
<tr class="separator:ade5fd276d5eb3eaafcddeadaa4ec40d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63b02037542ace1676b931448390b4fc"><td class="memItemLeft" align="right" valign="top"><a id="a63b02037542ace1676b931448390b4fc"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#a63b02037542ace1676b931448390b4fc">getLine</a> ()</td></tr>
<tr class="memdesc:a63b02037542ace1676b931448390b4fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">get just one line from the buf, update the buf if needed <br /></td></tr>
<tr class="separator:a63b02037542ace1676b931448390b4fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdeb38d3eb3d54d96481004ac1eb8e2f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#afdeb38d3eb3d54d96481004ac1eb8e2f">hasNoLineBreakAtEnd</a> ()</td></tr>
<tr class="memdesc:afdeb38d3eb3d54d96481004ac1eb8e2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tell whether the fastq file has no '<br />
' as a line break at the last line.  <a href="#afdeb38d3eb3d54d96481004ac1eb8e2f">More...</a><br /></td></tr>
<tr class="separator:afdeb38d3eb3d54d96481004ac1eb8e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47bb76400535f5c36f86ba73f67927a3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#a47bb76400535f5c36f86ba73f67927a3">isZipped</a> ()</td></tr>
<tr class="memdesc:a47bb76400535f5c36f86ba73f67927a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tell whether the fastq file is zipped or not.  <a href="#a47bb76400535f5c36f86ba73f67927a3">More...</a><br /></td></tr>
<tr class="separator:a47bb76400535f5c36f86ba73f67927a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad40d1e027a417f215307cd6adef4d505"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_read.html">Read</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#ad40d1e027a417f215307cd6adef4d505">read</a> ()</td></tr>
<tr class="memdesc:ad40d1e027a417f215307cd6adef4d505"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to get the next <a class="el" href="class_read.html" title="Class to represent a ngs read record.">Read</a> record from the current <a class="el" href="class_fq_reader.html" title="Class to hold a fastq reader.">FqReader</a>.  <a href="#ad40d1e027a417f215307cd6adef4d505">More...</a><br /></td></tr>
<tr class="separator:ad40d1e027a417f215307cd6adef4d505"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:af50ca4def94c24007b06011a92b2b45e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#af50ca4def94c24007b06011a92b2b45e">isfq</a> (const std::string &amp;filename)</td></tr>
<tr class="memdesc:af50ca4def94c24007b06011a92b2b45e"><td class="mdescLeft">&#160;</td><td class="mdescRight">tell whether the file is a fastq format file  <a href="#af50ca4def94c24007b06011a92b2b45e">More...</a><br /></td></tr>
<tr class="separator:af50ca4def94c24007b06011a92b2b45e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a617583d0e7c0b9425255cdaad52674a3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fq_reader.html#a617583d0e7c0b9425255cdaad52674a3">isZippedFq</a> (const std::string &amp;filename)</td></tr>
<tr class="memdesc:a617583d0e7c0b9425255cdaad52674a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">tell whether the file is a zipped fastq file  <a href="#a617583d0e7c0b9425255cdaad52674a3">More...</a><br /></td></tr>
<tr class="separator:a617583d0e7c0b9425255cdaad52674a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to hold a fastq reader. </p>

<p class="definition">Definition at line <a class="el" href="fqreader_8h_source.html#l00013">13</a> of file <a class="el" href="fqreader_8h_source.html">fqreader.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aaa7e02f18816df90b46c039cf59b48c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa7e02f18816df90b46c039cf59b48c1">&#9670;&nbsp;</a></span>FqReader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FqReader::FqReader </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>hasQuality</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>phread64</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a <a class="el" href="class_fq_reader.html" title="Class to hold a fastq reader.">FqReader</a> with filename and hasQuality, phread64. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Name of the fastq file </td></tr>
    <tr><td class="paramname">hasQuality</td><td>The fastq has quality sequence if true </td></tr>
    <tr><td class="paramname">phread64</td><td>The fastq quality sequence is encoded as ASCII 64 if true </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fqreader_8cpp_source.html#l00007">7</a> of file <a class="el" href="fqreader_8cpp_source.html">fqreader.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                                                                                         {</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    this-&gt;fileName = fileName;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    this-&gt;gzipFile = NULL;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    this-&gt;pfile = NULL;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    this-&gt;stdinMode = <span class="keyword">false</span>;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    this-&gt;phread64 = phread64;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    this-&gt;hasQuality = hasQuality;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    this-&gt;buf = <span class="keyword">new</span> <span class="keywordtype">char</span>[FQ_BUF_SIZE];</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    this-&gt;bufDataLen = 0;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    this-&gt;bufUsedLen = 0;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    this-&gt;noLineBreakAtEnd = <span class="keyword">false</span>;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    this-&gt;init();</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae0722aec7836a4c9b9eb6ff80263b246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0722aec7836a4c9b9eb6ff80263b246">&#9670;&nbsp;</a></span>eof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FqReader::eof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tell whether the <a class="el" href="class_fq_reader.html" title="Class to hold a fastq reader.">FqReader</a> has reach the endof file. </p>
<dl class="section return"><dt>Returns</dt><dd>true if eof reached </dd></dl>

<p class="definition">Definition at line <a class="el" href="fqreader_8cpp_source.html#l00158">158</a> of file <a class="el" href="fqreader_8cpp_source.html">fqreader.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                  {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span>(this-&gt;zipped){</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        return ::gzeof(this-&gt;gzipFile);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">return</span> std::feof(this-&gt;pfile);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="fqreader_8cpp_source.html#l00166">read()</a>.</p>

</div>
</div>
<a id="afdeb38d3eb3d54d96481004ac1eb8e2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdeb38d3eb3d54d96481004ac1eb8e2f">&#9670;&nbsp;</a></span>hasNoLineBreakAtEnd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FqReader::hasNoLineBreakAtEnd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tell whether the fastq file has no '<br />
' as a line break at the last line. </p>
<dl class="section return"><dt>Returns</dt><dd>true if the fastq file has no '<br />
' as a line break at the last line </dd></dl>

<p class="definition">Definition at line <a class="el" href="fqreader_8cpp_source.html#l00027">27</a> of file <a class="el" href="fqreader_8cpp_source.html">fqreader.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                                  {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">return</span> this-&gt;noLineBreakAtEnd;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="af50ca4def94c24007b06011a92b2b45e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af50ca4def94c24007b06011a92b2b45e">&#9670;&nbsp;</a></span>isfq()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FqReader::isfq </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tell whether the file is a fastq format file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>file name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the file is a fastq file(with suffix ".fastq", ".fasta", ".fq" or ".fa) </dd></dl>

<p class="definition">Definition at line <a class="el" href="fqreader_8cpp_source.html#l00225">225</a> of file <a class="el" href="fqreader_8cpp_source.html">fqreader.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                            {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// just use the suffix of filename to determine its format</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a>(filename, <span class="stringliteral">&quot;.fastq&quot;</span>) || <a class="code" href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a>(filename, <span class="stringliteral">&quot;.fq&quot;</span>) ||</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;       <a class="code" href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a>(filename, <span class="stringliteral">&quot;.fasta&quot;</span>) || <a class="code" href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a>(filename, <span class="stringliteral">&quot;.fa&quot;</span>)){</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div><div class="ttc" id="namespaceutil_html_a4e4b73830bf5adf8b9639a4d2a654145"><div class="ttname"><a href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a></div><div class="ttdeci">bool ends_with(const std::string &amp;str, const std::string &amp;suf)</div><div class="ttdoc">whether a string ends with some substring</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00034">util.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util_8h_source.html#l00034">util::ends_with()</a>.</p>

</div>
</div>
<a id="a47bb76400535f5c36f86ba73f67927a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47bb76400535f5c36f86ba73f67927a3">&#9670;&nbsp;</a></span>isZipped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FqReader::isZipped </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tell whether the fastq file is zipped or not. </p>
<dl class="section return"><dt>Returns</dt><dd>true if the fasq file is zipped </dd></dl>

<p class="definition">Definition at line <a class="el" href="fqreader_8cpp_source.html#l00234">234</a> of file <a class="el" href="fqreader_8cpp_source.html">fqreader.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                       {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">return</span> this-&gt;zipped;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a617583d0e7c0b9425255cdaad52674a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a617583d0e7c0b9425255cdaad52674a3">&#9670;&nbsp;</a></span>isZippedFq()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FqReader::isZippedFq </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tell whether the file is a zipped fastq file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>file name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the file is a zipped fastq file(with suffix ".fastq.gz", ".fasta.gz", ".fq.gz" or ".fa.gz") </dd></dl>

<p class="definition">Definition at line <a class="el" href="fqreader_8cpp_source.html#l00216">216</a> of file <a class="el" href="fqreader_8cpp_source.html">fqreader.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                  {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// just use the suffix of filename to determine its format</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a>(filename, <span class="stringliteral">&quot;.fastq.gz&quot;</span>) || <a class="code" href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a>(filename, <span class="stringliteral">&quot;.fq.gz&quot;</span>) ||</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;       <a class="code" href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a>(filename, <span class="stringliteral">&quot;.fasta.gz&quot;</span>) || <a class="code" href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a>(filename, <span class="stringliteral">&quot;.fa.gz&quot;</span>)){</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div><div class="ttc" id="namespaceutil_html_a4e4b73830bf5adf8b9639a4d2a654145"><div class="ttname"><a href="namespaceutil.html#a4e4b73830bf5adf8b9639a4d2a654145">util::ends_with</a></div><div class="ttdeci">bool ends_with(const std::string &amp;str, const std::string &amp;suf)</div><div class="ttdoc">whether a string ends with some substring</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00034">util.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util_8h_source.html#l00034">util::ends_with()</a>.</p>

</div>
</div>
<a id="ad40d1e027a417f215307cd6adef4d505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad40d1e027a417f215307cd6adef4d505">&#9670;&nbsp;</a></span>read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_read.html">Read</a> * FqReader::read </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to get the next <a class="el" href="class_read.html" title="Class to represent a ngs read record.">Read</a> record from the current <a class="el" href="class_fq_reader.html" title="Class to hold a fastq reader.">FqReader</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>a pointer to object <a class="el" href="class_read.html" title="Class to represent a ngs read record.">Read</a> read from the current <a class="el" href="class_fq_reader.html" title="Class to hold a fastq reader.">FqReader</a> or NULL if failed during reading </dd></dl>

<p class="definition">Definition at line <a class="el" href="fqreader_8cpp_source.html#l00166">166</a> of file <a class="el" href="fqreader_8cpp_source.html">fqreader.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span>(this-&gt;zipped &amp;&amp; this-&gt;gzipFile == NULL){</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span>(this-&gt;bufUsedLen &gt;= this-&gt;bufDataLen &amp;&amp; this-&gt;<a class="code" href="class_fq_reader.html#ae0722aec7836a4c9b9eb6ff80263b246">eof</a>()){</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    std::string name = this-&gt;<a class="code" href="class_fq_reader.html#a63b02037542ace1676b931448390b4fc">getLine</a>();</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">while</span>((name.empty() &amp;&amp; !(this-&gt;bufUsedLen &gt;= this-&gt;bufDataLen &amp;&amp; this-&gt;<a class="code" href="class_fq_reader.html#ae0722aec7836a4c9b9eb6ff80263b246">eof</a>())) || (!name.empty() &amp;&amp; name[0] !=<span class="charliteral">&#39;@&#39;</span>)){</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        name = this-&gt;<a class="code" href="class_fq_reader.html#a63b02037542ace1676b931448390b4fc">getLine</a>();</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span>(name.empty()){</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    std::string sequence = this-&gt;<a class="code" href="class_fq_reader.html#a63b02037542ace1676b931448390b4fc">getLine</a>();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    std::string strand = this-&gt;<a class="code" href="class_fq_reader.html#a63b02037542ace1676b931448390b4fc">getLine</a>();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// some fq has no quality, then construct the quality string with all &#39;K&#39;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span>(!this-&gt;hasQuality){</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        std::string quality = std::string(sequence.length(), <span class="charliteral">&#39;K&#39;</span>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_read.html">Read</a>(name, sequence, strand, quality, this-&gt;phread64);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        std::string quality = this-&gt;<a class="code" href="class_fq_reader.html#a63b02037542ace1676b931448390b4fc">getLine</a>();</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span>(quality.length() != sequence.length()){</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: base sequnce and quality sequence have different length: \n&quot;</span>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            std::cerr &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            std::cerr &lt;&lt; sequence &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            std::cerr &lt;&lt; quality &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            std::cerr &lt;&lt; strand &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_read.html">Read</a>(name, sequence, strand, quality, this-&gt;phread64);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div><div class="ttc" id="class_fq_reader_html_ae0722aec7836a4c9b9eb6ff80263b246"><div class="ttname"><a href="class_fq_reader.html#ae0722aec7836a4c9b9eb6ff80263b246">FqReader::eof</a></div><div class="ttdeci">bool eof()</div><div class="ttdoc">Tell whether the FqReader has reach the endof file.</div><div class="ttdef"><b>Definition:</b> <a href="fqreader_8cpp_source.html#l00158">fqreader.cpp:158</a></div></div>
<div class="ttc" id="class_read_html"><div class="ttname"><a href="class_read.html">Read</a></div><div class="ttdoc">Class to represent a ngs read record.</div><div class="ttdef"><b>Definition:</b> <a href="read_8h_source.html#l00013">read.h:13</a></div></div>
<div class="ttc" id="class_fq_reader_html_a63b02037542ace1676b931448390b4fc"><div class="ttname"><a href="class_fq_reader.html#a63b02037542ace1676b931448390b4fc">FqReader::getLine</a></div><div class="ttdeci">std::string getLine()</div><div class="ttdoc">get just one line from the buf, update the buf if needed</div><div class="ttdef"><b>Definition:</b> <a href="fqreader_8cpp_source.html#l00093">fqreader.cpp:93</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="fqreader_8cpp_source.html#l00158">eof()</a>, and <a class="el" href="fqreader_8cpp_source.html#l00093">getLine()</a>.</p>

<p class="reference">Referenced by <a class="el" href="evaluator_8cpp_source.html#l00102">Evaluator::computeOverRepSeq()</a>, and <a class="el" href="fqreader_8cpp_source.html#l00260">FqReaderPair::read()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="fqreader_8h_source.html">fqreader.h</a></li>
<li><a class="el" href="fqreader_8cpp_source.html">fqreader.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
